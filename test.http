### 1. ì‚¬ìš©ì ë¡œê·¸ì¸
POST http://localhost:3000/login
Content-Type: application/json

{
  "username": "user1",
  "password": "password123"
}

### 2. íšŒì›ê°€ì… í›„ ìë™ ë¡œê·¸ì¸
POST http://localhost:3000/register
Content-Type: application/json

{
  "username": "testuser",
  "email": "test@example.com",
  "password": "secure123"
}

### 3. ê´€ë¦¬ì ì „ìš© í˜ì´ì§€ ì ‘ê·¼
POST https://localhost:3000/login
Content-Type: application/json

{
  "username": "admin",
  "password": "adminpass"
}
###
GET https://localhost:3000/admin
Cookie: session=530893f81caf53a210c97e952a698aa2c708f1d77d9439f47f2cb72931da9ee3

### 4. ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
### 1. ë¡œê·¸ì¸ (ì„¸ì…˜ ì¿ í‚¤ ë°›ê¸°)
POST http://localhost:3000/login
Content-Type: application/json

{
  "username": "user1",
  "password": "newsecure456"
}

### 2. ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
POST http://localhost:3000/change-password
Content-Type: application/json
Cookie: session=e051325b7fb3e25eec9878eaad47f20e56def4326103398e39b68f90a8b2e5a3

{
  "oldPassword": "oldpassword123",
  "newPassword": "newsecure456"
}


### 5. ì„¸ì…˜ ìœ ì§€ ping
### 1ï¸âƒ£ ë¡œê·¸ì¸ ìš”ì²­ (ì„¸ì…˜ ì¿ í‚¤ ìƒì„±)
POST https://localhost:3000/login
Content-Type: application/json

{
  "username": "testuser"
}

### 2ï¸âƒ£ ì„¸ì…˜ í™•ì¸ ìš”ì²­ (/ping)
GET https://localhost:3000/ping
Cookie: session=82facd9bf9d75c8ed61418617d1a2d08a7d731aeb94d78a412d686100848a6bc

### 6. ë‹¤ì¤‘ ë¡œê·¸ì¸ ì°¨ë‹¨ ì•Œë¦¼
POST http://localhost:3000/notify-multi-login
Content-Type: application/json

{
  "userId": "testuser"
}

### 7. ìë™ ë¡œê·¸ì•„ì›ƒ ì„¤ì •
POST http://localhost:3000/set-auto-logout
Content-Type: application/json

{
  "timeoutMinutes": 15
}

### 8. ì´ë©”ì¼ ì¸ì¦ ì™„ë£Œ ì²˜ë¦¬
GET http://localhost:3000/verify-email?token=abc123

### 9. ë‹¤ë‹¨ê³„ ì¸ì¦ ì„±ê³µ ì²˜ë¦¬
POST http://localhost:3000/verify-otp
Content-Type: application/json

{
  "otp": "654321"
}

### 10. ë¡œê·¸ì¸ ìœ ì§€í•˜ê¸° (Remember me)
POST http://localhost:3000/remember-me
Content-Type: application/json

{
  "rememberMe": true
}


###vul1
### ğŸ§ª ë¡œê·¸ì¸ ì„±ê³µ (ì •ìƒ ìœ ì € ì •ë³´)
POST http://localhost:3000/login
Content-Type: application/json

{
  "username": "user1",
  "password": "password123"
}

### ğŸ§ª ë¡œê·¸ì¸ ì‹¤íŒ¨ (ë¹„ë°€ë²ˆí˜¸ í‹€ë¦¼)
POST http://localhost:3000/login
Content-Type: application/json

{
  "username": "user1",
  "password": "wrongpassword"
}

### ğŸ§ª ë¡œê·¸ì¸ ì‹¤íŒ¨ (ìœ ì € ì¡´ì¬í•˜ì§€ ì•ŠìŒ)
POST http://localhost:3000/login
Content-Type: application/json

{
  "username": "notexist",
  "password": "abc"
}

### ğŸ§ª ë¡œê·¸ì¸ ì‹¤íŒ¨ (ì…ë ¥ ìœ íš¨ì„± ì‹¤íŒ¨)
POST http://localhost:3000/login
Content-Type: application/json

{
  "username": "",
  "password": "   "
}


###vul2
### âœ… íšŒì›ê°€ì… ìš”ì²­ (ì •ìƒ)
POST http://localhost:3000/register
Content-Type: application/json

{
  "username": "alice",
  "email": "alice@example.com",
  "password": "alicepassword"
}

### ğŸ” ì¤‘ë³µ ì•„ì´ë””ë¡œ ì¬ê°€ì… ì‹œë„
POST http://localhost:3000/register
Content-Type: application/json

{
  "username": "alice",
  "email": "alice2@example.com",
  "password": "anotherpassword"
}

### âŒ ì˜ëª»ëœ ì´ë©”ì¼ í˜•ì‹
POST http://localhost:3000/register
Content-Type: application/json

{
  "username": "bob",
  "email": "invalid-email",
  "password": "bobpassword"
}

### âŒ ë¹ˆ ë¬¸ìì—´ ì…ë ¥
POST http://localhost:3000/register
Content-Type: application/json

{
  "username": "   ",
  "email": "bob@example.com",
  "password": "bobpassword"
}

###vul3
### ğŸ” 1. ì·¨ì•½ ì„¸ì…˜ ì¿ í‚¤ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ (íšŒì›ê°€ì… ì‹œ ìë™ ë¡œê·¸ì¸ ì¿ í‚¤)
POST https://localhost:3000/register
Content-Type: application/json

{
  "username": "vulnuser",
  "email": "vuln@example.com",
  "password": "vulnpass"
}

### ğŸ” 2. ì·¨ì•½ ì„¸ì…˜ ì¿ í‚¤ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ (ë¡œê·¸ì¸ ì‹œ ì¿ í‚¤)
POST https://localhost:3000/login
Content-Type: application/json

{
  "username": "vulnuser",
  "password": "vulnpass"
}

### ğŸ” 3. ì·¨ì•½ ì¿ í‚¤ ìˆ˜ë™ í¬í•¨ í›„ XSS ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ (í´ë¼ì´ì–¸íŠ¸ ì ‘ê·¼ ê°€ëŠ¥ ì—¬ë¶€)
GET http://localhost:3000/ping
Cookie: session=REPLACE_WITH_SESSION_TOKEN

### ğŸ” 4. XSSë¡œ ì„¸ì…˜ ì¿ í‚¤ íƒˆì·¨ ê°€ëŠ¥ì„± ì‹œë®¬ë ˆì´ì…˜ (ë¸Œë¼ìš°ì € ì½˜ì†”)
# ë¡œê·¸ì¸ í›„ ê°œë°œì ë„êµ¬ > Application > Cookies > session ì¿ í‚¤ í™•ì¸
# ì½˜ì†”ì—ì„œ ì•„ë˜ ì…ë ¥
document.cookie.includes("session=")   // trueë©´ HttpOnlyê°€ ëˆ„ë½ë˜ì–´ ìˆìŒ

###vul5
### âœ… 1. ë¡œê·¸ì¸ ìš”ì²­ â†’ session ì¿ í‚¤ ë°œê¸‰ (HttpOnly ë¯¸ì„¤ì • ê²€ì¦ ëŒ€ìƒ)
POST https://localhost:3000/login
Content-Type: application/json

{
  "username": "alice"
}

### âœ… 2. ë¡œê·¸ì¸ í›„ /ping ìš”ì²­ìœ¼ë¡œ ì„¸ì…˜ ìœ ì§€ í™•ì¸
GET https://localhost:3000/ping
Cookie: session=2818577fe03ceb67678f61ae6536dab0d5c57ed7a260dc34bff3001621f55d74
### âŒ 3. ì„¸ì…˜ ì—†ì´ /ping ìš”ì²­ (Unauthorized)
GET https://localhost:3000/ping

### ğŸ§ª 4. ì·¨ì•½ì  ê²€ì¦ (Set-Cookie í—¤ë” ì§ì ‘ í™•ì¸)
# ìœ„ 1ë²ˆ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µ í—¤ë” ì˜ˆì‹œ:
# Set-Cookie: session=abc123...; Secure; SameSite=Strict
# â†’ â— HttpOnly ì—†ìŒ = CWE-1004 ë°œìƒ

### ğŸ§ª 5. í´ë¼ì´ì–¸íŠ¸ì—ì„œ document.cookie ì ‘ê·¼ (ë¸Œë¼ìš°ì € ì½˜ì†”)
# ë¡œê·¸ì¸ í›„ ë¸Œë¼ìš°ì € ê°œë°œìë„êµ¬ â†’ ì½˜ì†”ì— ì•„ë˜ ì…ë ¥
document.cookie.includes("session=")  // trueë©´ HttpOnly ëˆ„ë½ë¨ â†’ ì·¨ì•½

###vul4
### âœ… 1. ë¡œê·¸ì¸ ì„±ê³µ â†’ ì„¸ì…˜ ì¿ í‚¤ ë°œê¸‰
POST http://localhost:3000/login
Content-Type: application/json

{
  "username": "user1",
  "password": "oldpassword123"
}

### âŒ 2. ë¡œê·¸ì¸ ì‹¤íŒ¨ (ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸)
POST http://localhost:3000/login
Content-Type: application/json

{
  "username": "user1",
  "password": "wrongpassword"
}

### âŒ 3. ë¡œê·¸ì¸ ì‹¤íŒ¨ (ì—†ëŠ” ì‚¬ìš©ì)
POST http://localhost:3000/login
Content-Type: application/json

{
  "username": "nouser",
  "password": "anypass"
}

### âœ… 4. ì„¸ì…˜ ì¿ í‚¤ í¬í•¨í•˜ì—¬ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ìš”ì²­
# 'session=' ê°’ì€ 1ë²ˆ ìš”ì²­ í›„ ì‘ë‹µì˜ Set-Cookie í—¤ë”ì—ì„œ ì¶”ì¶œí•´ ë„£ìœ¼ì„¸ìš”
POST http://localhost:3000/change-password
Content-Type: application/json
Cookie: session=REPLACE_WITH_SESSION_TOKEN

{
  "oldPassword": "oldpassword123",
  "newPassword": "newsecure456"
}

### âŒ 5. ì„¸ì…˜ ì—†ì´ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ìš”ì²­ (Unauthorized)
POST http://localhost:3000/change-password
Content-Type: application/json

{
  "oldPassword": "oldpassword123",
  "newPassword": "newsecure456"
}

### ğŸ§ª 6. ì‘ë‹µ í—¤ë”ì—ì„œ Set-Cookie í™•ì¸
# 1ë²ˆ ë¡œê·¸ì¸ ìš”ì²­ì˜ ì‘ë‹µ í—¤ë”ë¥¼ í™•ì¸:
# ì˜ˆì‹œ:
# Set-Cookie: session=abc123...; Secure; SameSite=Strict
# â— HttpOnlyê°€ **ì—†ìœ¼ë©´** â†’ CWE-1004 ë°œìƒ

